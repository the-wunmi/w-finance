<%# locals: (banks:) %>

<%= render DS::Dialog.new do |dialog| %>
  <% dialog.with_header(title: t(".title")) %>
  <% dialog.with_body do %>
    <div data-controller="list-filter">
      <div id="bank-selection">
        <div class="relative mb-4">
          <input type="search" 
                 autocomplete="off" 
                 placeholder="<%= t(".search_placeholder") %>"
                 data-list-filter-target="input"
                 data-action="input->list-filter#filter"
                 class="block w-full bg-container border border-secondary rounded-md py-2 pl-10 pr-3 focus:ring-gray-500 sm:text-sm">
          <%= icon("search", class: "absolute inset-y-0 left-2 top-1/2 transform -translate-y-1/2") %>
        </div>

        <div class="text-sm" data-list-filter-target="list">
          <% banks.each do |bank| %>
            <%= link_to bank_path(bank)  do %>
            <div class="filterable-item flex items-center gap-4 w-full text-primary focus:outline-hidden focus:bg-surface border border-transparent focus:border focus:border-gray-200 px-2 hover:bg-surface rounded-lg p-2" data-filter-name="<%= bank.display_name || bank.name %>">
              <% if bank.logo_url.present? %>
                <%= image_tag bank.logo_url,
                  class: "w-8 h-8 rounded-lg",
                  loading: "lazy" %>
              <% else %>
                <%= render DS::FilledIcon.new(
                  variant: :text,
                  text: bank.display_name || bank.name,
                ) %>
              <% end %>
              <div class="text-left">
                <div class="font-medium text-primary"><%= bank.display_name || bank.name %></div>
                <div class="text-sm text-secondary"><%= bank.country_code %></div>
              </div>
              </div>
            <% end %>
          <% end %>
        </div>

        <div data-list-filter-target="emptyMessage" class="hidden p-4 text-center text-secondary">
          <%= t(".no_banks_found") %>
        </div>
      </div>
    </div>
  <% end %>

  <% dialog.with_action(
    text: t(".cancel_button"), 
    variant: "ghost", 
    cancel_action: true
  ) %>
<% end %>
